<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/Pool.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> Pool.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/167</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/84</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/24</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/169</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">//SPDX-License-Identifier: TODO
pragma solidity ^0.8.0;
&nbsp;
import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
import "@openzeppelin/contracts/proxy/Clones.sol";
//import "@openzeppelin/contracts/proxy/utils/Initializable.sol";
//We aren't using the contracts-upgradable version of UUPSUpgradable because it doesn't
// have a constructor anyway and we don't want to pointlessly gunk up the storage
// with empty uint blocks of size 50 (as the upgradable versions of the contracts do).
import "@openzeppelin/contracts/proxy/utils/UUPSUpgradeable.sol";
&nbsp;
import "./interfaces/IPool.sol";
import "./interfaces/IRouting.sol";
&nbsp;
import "./LpToken.sol";
import "./Constants.sol";
import "./Invariant.sol";
import "./PoolMath.sol";
&nbsp;
//We'll use uint32 for timestamps. 2^32 seconds ~= 136 years, i.e. it will last us until the early
// 22nd century... so we ought to be fine.
&nbsp;
contract Pool is IPool, UUPSUpgradeable, Initializable {
&nbsp;
  struct TokenWithEqualizer { //uses 22/32 bytes of its slot
    address addr;
    int8 equalizer; //it's cheaper to (densely) store the equalizers than the blown up values
  }
&nbsp;
  using SafeERC20 for IERC20;
&nbsp;
  uint constant AMP_DECIMALS = 3;
  uint constant AMP_MULTIPLIER = 10**AMP_DECIMALS;
  IRouting constant ROUTING_CONTRACT = IRouting(address(0x0));
&nbsp;
  //slot (26/32 bytes used)
  uint8  public /*immutable*/ tokenCount;
  bool   public paused;
  uint32 public totalFee;
  uint32 public governanceFee;
  uint32 public ampInitialValue;
  uint32 public ampInitialTimestamp;
  uint32 public ampTargetValue;
  uint32 public ampTargetTimestamp;
&nbsp;
  //slot
  TokenWithEqualizer public /*immutable*/ lpTokenData;
&nbsp;
  //MAX_TOKEN_COUNT slots (save gas by not having to keccak)
  TokenWithEqualizer[MAX_TOKEN_COUNT] public /*immutable*/ poolTokensData;
&nbsp;
  //slot
  address public governance;
&nbsp;
  //slot
  address public governanceFeeRecipient;
&nbsp;
<span class="fstat-no" title="function not covered" >  function initialize(</span>
    string memory lpTokenName,
    string memory lpTokenSymbol,
    address lpTokenImpl,
    int8 lpTokenEqualizer,
    address[] memory poolTokenAddresses,
    int8[] memory poolTokenEqualizers,
    uint32 ampFactor,
    uint32 lpFee,
    uint32 _governanceFee,
    address _governanceFeeRecipient
  ) public initializer {
<span class="cstat-no" title="statement not covered" >    LpToken lpToken = LpToken(Clones.clone(lpTokenImpl));</span>
<span class="cstat-no" title="statement not covered" >    require(lpToken.initialize(lpTokenName, lpTokenSymbol), "LpToken initialization failed")</span>;
<span class="cstat-no" title="statement not covered" >    lpTokenData.addr = address(lpToken)</span>;
<span class="cstat-no" title="statement not covered" >    lpTokenData.equalizer = lpTokenEqualizer</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >    uint _tokenCount = poolTokenAddresses.length;</span>
<span class="cstat-no" title="statement not covered" >    require(_tokenCount &lt;= MAX_TOKEN_COUNT, "maximum supported token count exceeded")</span>;
<span class="cstat-no" title="statement not covered" >    require(poolTokenEqualizers.length == _tokenCount, "one token equalizer per token required")</span>;
<span class="cstat-no" title="statement not covered" >    tokenCount = uint8(_tokenCount)</span>;
&nbsp;
    //enforce that swimUSD is always the first token
<span class="cstat-no" title="statement not covered" >    require(poolTokenAddresses[0] == ROUTING_CONTRACT.swimUsdAddress())</span>;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
      //TODO do we want any form of checking here? (e.g. duplicates)
<span class="cstat-no" title="statement not covered" >      poolTokensData[i].addr = poolTokenAddresses[i]</span>;
<span class="cstat-no" title="statement not covered" >      require(</span>
        poolTokenEqualizers[i] &gt;= MIN_EQUALIZER &amp;&amp; poolTokenEqualizers[i] &lt;= MAX_EQUALIZER,
        "invalid equalizer value"
      );
<span class="cstat-no" title="statement not covered" >      poolTokensData[i].equalizer = poolTokenEqualizers[i]</span>;
    }
&nbsp;
    //ampFactor == 0 =&gt; constant product (only supported for 2 tokens)
<span class="cstat-no" title="statement not covered" >    require(ampFactor &lt;= MAX_AMP_FACTOR, "maximum amp factor exceeded")</span>;
<span class="cstat-no" title="statement not covered" >    require(</span>
      ampFactor &gt;= ONE_AMP_SHIFTED || (ampFactor == 0 &amp;&amp; _tokenCount == 2),
      "invalid amp factor"
    );
<span class="cstat-no" title="statement not covered" >    ampInitialValue = 0</span>;
<span class="cstat-no" title="statement not covered" >    ampInitialTimestamp = 0</span>;
<span class="cstat-no" title="statement not covered" >    ampTargetValue = ampFactor &lt;&lt; uint32(AMP_SHIFT)</span>;
<span class="cstat-no" title="statement not covered" >    ampTargetTimestamp = 0</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >    governanceFeeRecipient = _governanceFeeRecipient</span>;
<span class="cstat-no" title="statement not covered" >    _setFees(lpFee, _governanceFee)</span>;
<span class="cstat-no" title="statement not covered" >    paused = false</span>;
<span class="cstat-no" title="statement not covered" >    governance = msg.sender</span>;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  modifier notPaused {</span>
<span class="cstat-no" title="statement not covered" >    require(!paused)</span>;
    _;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  modifier onlyGovernance {</span>
<span class="cstat-no" title="statement not covered" >    require(msg.sender == governance)</span>;
    _;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getState() external view returns(PoolState memory) {</span>
<span class="cstat-no" title="statement not covered" >    PoolState memory state = PoolState(</span>
      paused,
      new TokenBalance[](poolTokensData.length),
      TokenBalance(lpTokenData.addr, LpToken(lpTokenData.addr).totalSupply()),
      Decimal((getAmpFactor() * AMP_MULTIPLIER) &gt;&gt; AMP_SHIFT, uint8(AMP_DECIMALS)),
      Decimal(totalFee-governanceFee, uint8(FEE_DECIMALS)),
      Decimal(governanceFee, uint8(FEE_DECIMALS))
    );
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; poolTokensData.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      state.balances[i] = TokenBalance(</span>
        poolTokensData[i].addr,
        IERC20(poolTokensData[i].addr).balanceOf(address(this))
      );
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return state;</span>
  }
&nbsp;
  // ----------------------------- DEFI LIQUIDITY -----------------------------
&nbsp;
  //always available, even when paused!
  //maximally robust and conservative implementation
<span class="fstat-no" title="function not covered" >  function removeUniform(uint burnAmount, uint[] memory minimumOutputAmounts)</span>
    external returns(uint[] memory outputAmounts) {
<span class="cstat-no" title="statement not covered" >    uint _tokenCount = tokenCount;</span>
<span class="cstat-no" title="statement not covered" >    LpToken lpToken = LpToken(lpTokenData.addr);</span>
<span class="cstat-no" title="statement not covered" >    uint totalLpSupply = lpToken.totalSupply();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    lpToken.burnFrom(msg.sender, burnAmount)</span>;
<span class="cstat-no" title="statement not covered" >    outputAmounts = new uint[](_tokenCount)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      IERC20 poolToken = IERC20(poolTokensData[i].addr);</span>
<span class="cstat-no" title="statement not covered" >      uint poolBalance = poolToken.balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >      uint outputAmount = poolBalance * burnAmount / totalLpSupply;</span> //SafeMath!
<span class="cstat-no" title="statement not covered" >      require(outputAmount &gt;= minimumOutputAmounts[i])</span>;
<span class="cstat-no" title="statement not covered" >      poolToken.safeTransfer(msg.sender, outputAmount)</span>;
<span class="cstat-no" title="statement not covered" >      outputAmounts[i] = outputAmount</span>;
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function add(</span>
    uint[] memory inputAmounts,
    uint minimumMintAmount
  ) external notPaused returns(uint mintAmount) { unchecked {
<span class="cstat-no" title="statement not covered" >    (uint _tokenCount, LpToken lpToken, int8 lpEqualizer, PoolMath.Pool memory pool) = defiParas();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    Equalized[] memory eInputAmounts = equalizeAmounts(inputAmounts, _tokenCount);</span>
<span class="cstat-no" title="statement not covered" >    Equalized eMintAmount;</span>
<span class="cstat-no" title="statement not covered" >    if (Equalized.unwrap(pool.totalLpSupply) == 0) {</span>
<span class="cstat-no" title="statement not covered" >      for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >        require(inputAmounts[i] &gt; 0, "Initial add must include all tokens")</span>;
      }
<span class="cstat-no" title="statement not covered" >      uint depth = Invariant.calculateDepth(eInputAmounts, pool.ampFactor, 0);</span>
      //In all other circumstances, the amount of LP tokens minted or burned is
      // proportional to the generated/consumed depth, where the current depth
      // of the pool represents the the total LP supply.
      //In case the pool is empty however, this correspondence isn't meaningful
      // yet and hence needs to be established.
      //Technically speaking, wraping depth in Equalized here is a bit of
      // an abuse because Equalizeds are supposed to only take up to 61
      // bits while depth can take up to 64 bits.
<span class="cstat-no" title="statement not covered" >      eMintAmount = Equalized.wrap(depth)</span>;
    }
    else {
<span class="cstat-no" title="statement not covered" >      Equalized eGovernanceMintAmount;</span>
<span class="cstat-no" title="statement not covered" >      (eMintAmount, eGovernanceMintAmount) = PoolMath.addRemove(true, eInputAmounts, pool)</span>;
<span class="cstat-no" title="statement not covered" >      mintGovernanceFee(eGovernanceMintAmount, lpToken, lpEqualizer)</span>;
    }
<span class="cstat-no" title="statement not covered" >    mintAmount = Equalize.from(eMintAmount, lpEqualizer)</span>;
<span class="cstat-no" title="statement not covered" >    require(mintAmount &gt;= minimumMintAmount)</span>;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      safeTransferFrom(inputAmounts[i], i)</span>;
    }
<span class="cstat-no" title="statement not covered" >    lpToken.mint(msg.sender, mintAmount)</span>;
  }}
&nbsp;
<span class="fstat-no" title="function not covered" >  function removeExactOutput(</span>
    uint[] memory outputAmounts,
    uint maximumBurnAmount
  ) external notPaused returns(uint burnAmount) { unchecked {
<span class="cstat-no" title="statement not covered" >    (uint _tokenCount, LpToken lpToken, int8 lpEqualizer, PoolMath.Pool memory pool) = defiParas();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    Equalized[] memory eOutputAmounts = equalizeAmounts(outputAmounts, _tokenCount);</span>
    //We could also immediately transfer, but that would be a lot more gas inefficient for
    // transactions that fail due to slippage.
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount;  ++i) {</span>
<span class="cstat-no" title="statement not covered" >      require(</span>
        Equalized.unwrap(eOutputAmounts[i]) &lt; Equalized.unwrap(pool.balances[i])
      );
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    (Equalized eBurnAmount, Equalized eGovernanceMintAmount) =</span>
     PoolMath.addRemove(false, eOutputAmounts, pool);
&nbsp;
<span class="cstat-no" title="statement not covered" >    burnAmount = Equalize.from(eBurnAmount, lpEqualizer)</span>;
<span class="cstat-no" title="statement not covered" >    require(burnAmount &lt;= maximumBurnAmount)</span>;
<span class="cstat-no" title="statement not covered" >    lpToken.burnFrom(msg.sender, burnAmount)</span>;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      safeTransfer(outputAmounts[i], i)</span>;
    }
<span class="cstat-no" title="statement not covered" >    mintGovernanceFee(eGovernanceMintAmount, lpToken, lpEqualizer)</span>;
  }}
&nbsp;
<span class="fstat-no" title="function not covered" >  function removeExactBurn(</span>
    uint burnAmount,
    uint8 outputTokenIndex,
    uint minimumOutputAmount
  ) external notPaused returns(uint outputAmount) {
<span class="cstat-no" title="statement not covered" >    (uint _tokenCount, LpToken lpToken, int8 lpEqualizer, PoolMath.Pool memory pool) = defiParas();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    require(outputTokenIndex &lt; _tokenCount)</span>;
<span class="cstat-no" title="statement not covered" >    Equalized eBurnAmount = Equalize.to(burnAmount, lpEqualizer);</span>
    //We could also immediately transfer, but that would be a lot more gas inefficient for
    // transactions that fail due to slippage.
<span class="cstat-no" title="statement not covered" >    require(Equalized.unwrap(eBurnAmount) &lt; Equalized.unwrap(pool.totalLpSupply))</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >    (Equalized eOutputAmount, Equalized eGovernanceMintAmount) =</span>
      PoolMath.removeExactBurn(eBurnAmount, outputTokenIndex, pool);
&nbsp;
<span class="cstat-no" title="statement not covered" >    outputAmount = Equalize.from(eOutputAmount, poolTokensData[outputTokenIndex].equalizer)</span>;
<span class="cstat-no" title="statement not covered" >    require(outputAmount &gt;= minimumOutputAmount)</span>;
<span class="cstat-no" title="statement not covered" >    lpToken.burnFrom(msg.sender, burnAmount)</span>;
<span class="cstat-no" title="statement not covered" >    safeTransfer(outputAmount, outputTokenIndex)</span>;
<span class="cstat-no" title="statement not covered" >    mintGovernanceFee(eGovernanceMintAmount, lpToken, lpEqualizer)</span>;
  }
&nbsp;
  // ------------------------------- DEFI SWAP --------------------------------
&nbsp;
  //called by swap(), hence public and not restricted to external
<span class="fstat-no" title="function not covered" >  function swapExactInput(</span>
    uint[] memory inputAmounts,
    uint8 outputTokenIndex,
    uint minimumOutputAmount
  ) external notPaused returns(uint outputAmount) { unchecked {
<span class="cstat-no" title="statement not covered" >    (uint _tokenCount, LpToken lpToken, int8 lpEqualizer, PoolMath.Pool memory pool) = defiParas();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    require(outputTokenIndex &lt; _tokenCount)</span>;
<span class="cstat-no" title="statement not covered" >    require(inputAmounts[outputTokenIndex] == 0)</span>;
<span class="cstat-no" title="statement not covered" >    Equalized[] memory eInputAmounts = equalizeAmounts(inputAmounts, _tokenCount);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    (Equalized eOutputAmount, Equalized eGovernanceMintAmount) =</span>
      PoolMath.swap(true, eInputAmounts, outputTokenIndex, pool);
&nbsp;
<span class="cstat-no" title="statement not covered" >    outputAmount = Equalize.from(eOutputAmount, poolTokensData[outputTokenIndex].equalizer)</span>;
<span class="cstat-no" title="statement not covered" >    require(outputAmount &gt;= minimumOutputAmount)</span>;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      safeTransferFrom(inputAmounts[i], i)</span>;
    }
<span class="cstat-no" title="statement not covered" >    safeTransfer(outputAmount, outputTokenIndex)</span>;
<span class="cstat-no" title="statement not covered" >    mintGovernanceFee(eGovernanceMintAmount, lpToken, lpEqualizer)</span>;
  }}
&nbsp;
<span class="fstat-no" title="function not covered" >  function swapExactOutput(</span>
    uint maximumInputAmount,
    uint8 inputTokenIndex,
    uint[] memory outputAmounts
  ) external notPaused returns(uint inputAmount) { unchecked {
<span class="cstat-no" title="statement not covered" >    (uint _tokenCount, LpToken lpToken, int8 lpEqualizer, PoolMath.Pool memory pool) = defiParas();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    require(inputTokenIndex &lt; _tokenCount)</span>;
<span class="cstat-no" title="statement not covered" >    require(outputAmounts[inputTokenIndex] == 0)</span>;
<span class="cstat-no" title="statement not covered" >    Equalized[] memory eOutputAmounts = equalizeAmounts(outputAmounts, _tokenCount);</span>
    //We could also immediately transfer, but that would be a lot more gas inefficient for
    // transactions that fail due to slippage.
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      require(</span>
        Equalized.unwrap(eOutputAmounts[i]) &lt; Equalized.unwrap(pool.balances[i])
      );
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    (Equalized eInputAmount, Equalized eGovernanceMintAmount) =</span>
      PoolMath.swap(false, eOutputAmounts, inputTokenIndex, pool);
&nbsp;
<span class="cstat-no" title="statement not covered" >    inputAmount = Equalize.from(eInputAmount, poolTokensData[inputTokenIndex].equalizer)</span>;
<span class="cstat-no" title="statement not covered" >    require(inputAmount &lt;= maximumInputAmount)</span>;
<span class="cstat-no" title="statement not covered" >    safeTransferFrom(inputAmount, inputTokenIndex)</span>;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      safeTransfer(outputAmounts[i], i)</span>;
    }
<span class="cstat-no" title="statement not covered" >    mintGovernanceFee(eGovernanceMintAmount, lpToken, lpEqualizer)</span>;
  }}
&nbsp;
  //allows swapping with the pool without having to know/look up its tokenCount
<span class="fstat-no" title="function not covered" >  function swap(</span>
    uint inputAmount,
    uint8 inputTokenIndex,
    uint8 outputTokenIndex,
    uint minimumOutputAmount
  ) external notPaused returns(uint outputAmount) { unchecked {
<span class="cstat-no" title="statement not covered" >    (uint _tokenCount, LpToken lpToken, int8 lpEqualizer, PoolMath.Pool memory pool) = defiParas();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    require(inputTokenIndex &lt; _tokenCount)</span>;
<span class="cstat-no" title="statement not covered" >    require(outputTokenIndex &lt; _tokenCount)</span>;
<span class="cstat-no" title="statement not covered" >    require(inputTokenIndex != outputTokenIndex)</span>;
    //Solidity guarantees default initialization, even if memory was previously dirty, so we don't
    // have to zero initialize ourselves.
<span class="cstat-no" title="statement not covered" >    Equalized[] memory eInputAmounts = new Equalized[](_tokenCount);</span>
<span class="cstat-no" title="statement not covered" >    eInputAmounts[inputTokenIndex] =</span>
      Equalize.to(inputAmount, poolTokensData[inputTokenIndex].equalizer);
&nbsp;
<span class="cstat-no" title="statement not covered" >    (Equalized eOutputAmount, Equalized eGovernanceMintAmount) =</span>
      PoolMath.swap(true, eInputAmounts, outputTokenIndex, pool);
&nbsp;
<span class="cstat-no" title="statement not covered" >    outputAmount = Equalize.from(eOutputAmount, poolTokensData[outputTokenIndex].equalizer)</span>;
<span class="cstat-no" title="statement not covered" >    require(outputAmount &gt;= minimumOutputAmount)</span>;
<span class="cstat-no" title="statement not covered" >    safeTransferFrom(inputAmount, inputTokenIndex)</span>;
<span class="cstat-no" title="statement not covered" >    safeTransfer(outputAmount, outputTokenIndex)</span>;
<span class="cstat-no" title="statement not covered" >    mintGovernanceFee(eGovernanceMintAmount, lpToken, lpEqualizer)</span>;
  }}
&nbsp;
  // ------------------------------- GOVERNANCE -------------------------------
&nbsp;
<span class="fstat-no" title="function not covered" >  function setFees(uint32 lpFee, uint32 _governanceFee) external onlyGovernance {</span>
<span class="cstat-no" title="statement not covered" >    _setFees(lpFee, _governanceFee)</span>;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function adjustAmpFactor(uint32 targetValue, uint32 targetTimestamp) external onlyGovernance {</span>
<span class="cstat-no" title="statement not covered" >    uint currentAmpFactor = uint(getAmpFactor());</span>
<span class="cstat-no" title="statement not covered" >    require(</span>
      currentAmpFactor != 0,
      "can't change amp factor of constant product pool"
    );
<span class="cstat-no" title="statement not covered" >    require(targetValue &lt;= MAX_AMP_FACTOR, "maximum amp factor exceeded")</span>;
<span class="cstat-no" title="statement not covered" >    uint _ampTargetValue = uint(targetValue) &lt;&lt; AMP_SHIFT;</span>
<span class="cstat-no" title="statement not covered" >    require(_ampTargetValue &gt;= ONE_AMP_SHIFTED, "below minimum amp factor")</span>;
<span class="cstat-no" title="statement not covered" >    require(</span>
      uint(targetTimestamp) &gt; block.timestamp + MIN_AMP_ADJUSTMENT_WINDOW,
      "target timestamp not far enough in the future"
    );
<span class="cstat-no" title="statement not covered" >    require(</span>
      (currentAmpFactor &lt;= _ampTargetValue &amp;&amp;
        (currentAmpFactor * MAX_AMP_RELATIVE_ADJUSTMENT &gt;= _ampTargetValue)) ||
      (currentAmpFactor &gt; _ampTargetValue &amp;&amp;
       (currentAmpFactor &lt;= _ampTargetValue * MAX_AMP_RELATIVE_ADJUSTMENT)),
      "exceeding maximum relative adjustment"
    );
&nbsp;
<span class="cstat-no" title="statement not covered" >    ampInitialValue = uint32(block.timestamp)</span>;
<span class="cstat-no" title="statement not covered" >    ampInitialTimestamp = uint32(currentAmpFactor)</span>;
<span class="cstat-no" title="statement not covered" >    ampTargetValue = uint32(_ampTargetValue)</span>;
<span class="cstat-no" title="statement not covered" >    ampTargetTimestamp = targetTimestamp</span>;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function setPaused(bool _paused) external onlyGovernance {</span>
<span class="cstat-no" title="statement not covered" >    paused = _paused</span>;
    //emit event
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function transferGovernance(address _governance) external onlyGovernance {</span>
<span class="cstat-no" title="statement not covered" >    governance = _governance</span>;
    //emit event
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function changeGovernanceFeeRecipient(address _governanceFeeRecipient) external onlyGovernance {</span>
<span class="cstat-no" title="statement not covered" >    require(totalFee == 0 || _governanceFeeRecipient != address(0))</span>;
<span class="cstat-no" title="statement not covered" >    governanceFeeRecipient = _governanceFeeRecipient</span>;
    //emit event
  }
&nbsp;
  //intentionally empty (we only want the onlyGovernance modifier "side-effect")
<span class="fstat-no" title="function not covered" >  function _authorizeUpgrade(address) internal override onlyGovernance {}</span>
&nbsp;
  // -------------------------------- INTERNAL --------------------------------
&nbsp;
<span class="fstat-no" title="function not covered" >  function _setFees(uint32 lpFee, uint32 _governanceFee) internal {</span>
<span class="cstat-no" title="statement not covered" >    uint32 _totalFee = lpFee + _governanceFee;</span> //SafeMath!
    //We're limiting total fees to less than 50 % because:
    // 1) Anything even close to approaching this is already entirely insane.
    // 2) To avoid theoretical overflow/underflow issues when calculating the inverse fee,
    //    of 1/(1-fee)-1 would exceed 100 % if fee were to exceeds 50 %.
<span class="cstat-no" title="statement not covered" >    require(_totalFee &lt; FEE_DECIMAL_FACTOR/2, "total fee has to be less than 50 %")</span>;
<span class="cstat-no" title="statement not covered" >    require(_totalFee == 0 || governanceFeeRecipient != address(0))</span>;
<span class="cstat-no" title="statement not covered" >    totalFee = _totalFee</span>;
<span class="cstat-no" title="statement not covered" >    governanceFee = _governanceFee</span>;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function safeTransferFrom(uint inputAmount, uint tokenIndex) internal {</span>
<span class="cstat-no" title="statement not covered" >    if (inputAmount &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >      IERC20 poolToken = IERC20(poolTokensData[tokenIndex].addr);</span>
<span class="cstat-no" title="statement not covered" >      poolToken.safeTransferFrom(msg.sender, address(this), inputAmount)</span>;
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function safeTransfer(uint outputAmount, uint tokenIndex) internal {</span>
<span class="cstat-no" title="statement not covered" >    if (outputAmount &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >      IERC20 poolToken = IERC20(poolTokensData[tokenIndex].addr);</span>
<span class="cstat-no" title="statement not covered" >      poolToken.safeTransfer(msg.sender, outputAmount)</span>;
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function mintGovernanceFee(</span>
    Equalized eGovernanceMintAmount,
    LpToken lpToken,
    int8 lpEqualizer
  ) internal {
<span class="cstat-no" title="statement not covered" >    if (Equalized.unwrap(eGovernanceMintAmount) != 0) {</span>
<span class="cstat-no" title="statement not covered" >      uint governanceLpFee = Equalize.from(eGovernanceMintAmount, lpEqualizer);</span>
<span class="cstat-no" title="statement not covered" >      lpToken.mint(governanceFeeRecipient, governanceLpFee)</span>;
    }
  }
&nbsp;
  // ------------------------------ INTERNAL VIEW -----------------------------
&nbsp;
<span class="fstat-no" title="function not covered" >  function equalizeAmounts(uint[] memory amounts, uint _tokenCount)</span>
    internal view returns(Equalized[] memory equalized) {
<span class="cstat-no" title="statement not covered" >    require(amounts.length == _tokenCount, "invalid number of passed token amounts")</span>;
<span class="cstat-no" title="statement not covered" >    equalized = new Equalized[](_tokenCount)</span>;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      equalized[i] = Equalize.to(amounts[i], poolTokensData[i].equalizer)</span>;
    }
  }
&nbsp;
  //function for cutting down on boiler plate code
  // (and reading storage variables only once to optimize gas costs)
<span class="fstat-no" title="function not covered" >  function defiParas() internal view returns(</span>
    uint _tokenCount, //gas optimization
    LpToken lpToken,
    int8 lpEqualizer, //gas optimization
    PoolMath.Pool memory pool
  ) { unchecked {
<span class="cstat-no" title="statement not covered" >    _tokenCount = tokenCount</span>;
<span class="cstat-no" title="statement not covered" >    lpToken = LpToken(lpTokenData.addr)</span>;
<span class="cstat-no" title="statement not covered" >    lpEqualizer = lpTokenData.equalizer</span>;
<span class="cstat-no" title="statement not covered" >    pool = PoolMath.Pool(</span>
      uint8(_tokenCount),
      new Equalized[](_tokenCount),
      getAmpFactor(),
      totalFee,
      governanceFee,
      Equalize.to(lpToken.totalSupply(), lpEqualizer)
    );
&nbsp;
<span class="cstat-no" title="statement not covered" >    for (uint i = 0; i &lt; _tokenCount; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      uint balance = IERC20(poolTokensData[i].addr).balanceOf(address(this));</span>
<span class="cstat-no" title="statement not covered" >      pool.balances[i] = Equalize.to(balance, poolTokensData[i].equalizer)</span>;
    }
  }}
&nbsp;
<span class="fstat-no" title="function not covered" >  function getAmpFactor() internal view returns(uint32 ampFactor) { unchecked {</span>
<span class="cstat-no" title="statement not covered" >    int currentTimestamp = int(block.timestamp);</span>
<span class="cstat-no" title="statement not covered" >    int _ampTargetTimestamp = int(uint(ampTargetTimestamp));</span>
<span class="cstat-no" title="statement not covered" >    if (currentTimestamp &lt; _ampTargetTimestamp) {</span>
<span class="cstat-no" title="statement not covered" >      int _ampInitialTimestamp = int(uint(ampInitialTimestamp));</span>
<span class="cstat-no" title="statement not covered" >      int _ampInitialValue = int(uint(ampInitialValue));</span>
<span class="cstat-no" title="statement not covered" >      int _ampTargetValue = int(uint(ampTargetValue));</span>
<span class="cstat-no" title="statement not covered" >      int totalValueDifference = _ampTargetValue - _ampInitialValue;</span>
<span class="cstat-no" title="statement not covered" >      int timeSinceInitial = currentTimestamp - _ampInitialTimestamp;</span>
<span class="cstat-no" title="statement not covered" >      int totalAdjustmentTime = _ampTargetTimestamp - _ampInitialTimestamp;</span>
<span class="cstat-no" title="statement not covered" >      int delta = totalValueDifference * timeSinceInitial / totalAdjustmentTime;</span>
<span class="cstat-no" title="statement not covered" >      ampFactor = uint32(uint(_ampInitialValue + delta))</span>;
    }
    else {
<span class="cstat-no" title="statement not covered" >      ampFactor = uint32(uint(ampTargetValue))</span>;
    }
  }}
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Jul 12 2022 12:54:42 GMT+0200 (Central European Summer Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
